{"ast":null,"code":"import axios from 'axios';\nimport { useAuthStore } from '@/stores/auth';\nconst instance = axios.create({\n  baseURL: 'http://localhost:8080'\n});\n\n// 请求拦截器 - 自动添加 token 到请求头\ninstance.interceptors.request.use(config => {\n  const authStore = useAuthStore();\n  console.log('请求拦截器 - 当前token:', authStore.token);\n  if (authStore.token) {\n    config.headers.Authorization = `Bearer ${authStore.token}`;\n    console.log('已添加Authorization头:', config.headers.Authorization);\n  } else {\n    console.log('没有找到token，跳过Authorization头');\n  }\n  return config;\n}, error => {\n  return Promise.reject(error);\n});\n\n// 响应拦截器\ninstance.interceptors.response.use(response => {\n  console.log('响应拦截器 - 原始响应:', response);\n  console.log('响应拦截器 - response.data:', response.data);\n  const result = response.data;\n  console.log('响应拦截器 - result:', result);\n  console.log('响应拦截器 - result.code:', result.code);\n  if (result.code === 0) {\n    console.log('响应拦截器 - 成功，返回data:', result.data);\n    return result.data;\n  } else {\n    console.log('响应拦截器 - 失败，错误信息:', result.message);\n    alert(result.message || '服务异常');\n    return Promise.reject(result);\n  }\n}, error => {\n  console.error('响应拦截器 - 请求异常:', error);\n  alert('请求异常');\n  return Promise.reject(error);\n});\nexport default instance;","map":{"version":3,"names":["axios","useAuthStore","instance","create","baseURL","interceptors","request","use","config","authStore","console","log","token","headers","Authorization","error","Promise","reject","response","data","result","code","message","alert"],"sources":["D:/数据库课程设计（饭店系统）/restaurant-ordering-system/src/utils/request.js"],"sourcesContent":["import axios from 'axios';\r\nimport { useAuthStore } from '@/stores/auth';\r\n\r\nconst instance = axios.create(\r\n    {\r\n        baseURL:'http://localhost:8080',\r\n    }\r\n);\r\n\r\n// 请求拦截器 - 自动添加 token 到请求头\r\ninstance.interceptors.request.use(\r\n    (config) => {\r\n        const authStore = useAuthStore();\r\n        console.log('请求拦截器 - 当前token:', authStore.token);\r\n        if (authStore.token) {\r\n            config.headers.Authorization = `Bearer ${authStore.token}`;\r\n            console.log('已添加Authorization头:', config.headers.Authorization);\r\n        } else {\r\n            console.log('没有找到token，跳过Authorization头');\r\n        }\r\n        return config;\r\n    },\r\n    (error) => {\r\n        return Promise.reject(error);\r\n    }\r\n);\r\n\r\n// 响应拦截器\r\ninstance.interceptors.response.use(\r\n    (response) =>{\r\n        console.log('响应拦截器 - 原始响应:', response);\r\n        console.log('响应拦截器 - response.data:', response.data);\r\n        \r\n        const result = response.data;\r\n        console.log('响应拦截器 - result:', result);\r\n        console.log('响应拦截器 - result.code:', result.code);\r\n        \r\n        if(result.code === 0){\r\n            console.log('响应拦截器 - 成功，返回data:', result.data);\r\n            return result.data;\r\n        }else{\r\n            console.log('响应拦截器 - 失败，错误信息:', result.message);\r\n            alert(result.message||'服务异常');\r\n            return Promise.reject(result);\r\n        }      \r\n    },\r\n    (error) =>{\r\n        console.error('响应拦截器 - 请求异常:', error);\r\n        alert('请求异常');\r\n        return Promise.reject(error);\r\n    }\r\n)\r\n\r\nexport default instance;"],"mappings":"AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAASC,YAAY,QAAQ,eAAe;AAE5C,MAAMC,QAAQ,GAAGF,KAAK,CAACG,MAAM,CACzB;EACIC,OAAO,EAAC;AACZ,CACJ,CAAC;;AAED;AACAF,QAAQ,CAACG,YAAY,CAACC,OAAO,CAACC,GAAG,CAC5BC,MAAM,IAAK;EACR,MAAMC,SAAS,GAAGR,YAAY,CAAC,CAAC;EAChCS,OAAO,CAACC,GAAG,CAAC,kBAAkB,EAAEF,SAAS,CAACG,KAAK,CAAC;EAChD,IAAIH,SAAS,CAACG,KAAK,EAAE;IACjBJ,MAAM,CAACK,OAAO,CAACC,aAAa,GAAG,UAAUL,SAAS,CAACG,KAAK,EAAE;IAC1DF,OAAO,CAACC,GAAG,CAAC,oBAAoB,EAAEH,MAAM,CAACK,OAAO,CAACC,aAAa,CAAC;EACnE,CAAC,MAAM;IACHJ,OAAO,CAACC,GAAG,CAAC,4BAA4B,CAAC;EAC7C;EACA,OAAOH,MAAM;AACjB,CAAC,EACAO,KAAK,IAAK;EACP,OAAOC,OAAO,CAACC,MAAM,CAACF,KAAK,CAAC;AAChC,CACJ,CAAC;;AAED;AACAb,QAAQ,CAACG,YAAY,CAACa,QAAQ,CAACX,GAAG,CAC7BW,QAAQ,IAAI;EACTR,OAAO,CAACC,GAAG,CAAC,eAAe,EAAEO,QAAQ,CAAC;EACtCR,OAAO,CAACC,GAAG,CAAC,wBAAwB,EAAEO,QAAQ,CAACC,IAAI,CAAC;EAEpD,MAAMC,MAAM,GAAGF,QAAQ,CAACC,IAAI;EAC5BT,OAAO,CAACC,GAAG,CAAC,iBAAiB,EAAES,MAAM,CAAC;EACtCV,OAAO,CAACC,GAAG,CAAC,sBAAsB,EAAES,MAAM,CAACC,IAAI,CAAC;EAEhD,IAAGD,MAAM,CAACC,IAAI,KAAK,CAAC,EAAC;IACjBX,OAAO,CAACC,GAAG,CAAC,oBAAoB,EAAES,MAAM,CAACD,IAAI,CAAC;IAC9C,OAAOC,MAAM,CAACD,IAAI;EACtB,CAAC,MAAI;IACDT,OAAO,CAACC,GAAG,CAAC,kBAAkB,EAAES,MAAM,CAACE,OAAO,CAAC;IAC/CC,KAAK,CAACH,MAAM,CAACE,OAAO,IAAE,MAAM,CAAC;IAC7B,OAAON,OAAO,CAACC,MAAM,CAACG,MAAM,CAAC;EACjC;AACJ,CAAC,EACAL,KAAK,IAAI;EACNL,OAAO,CAACK,KAAK,CAAC,eAAe,EAAEA,KAAK,CAAC;EACrCQ,KAAK,CAAC,MAAM,CAAC;EACb,OAAOP,OAAO,CAACC,MAAM,CAACF,KAAK,CAAC;AAChC,CACJ,CAAC;AAED,eAAeb,QAAQ","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}