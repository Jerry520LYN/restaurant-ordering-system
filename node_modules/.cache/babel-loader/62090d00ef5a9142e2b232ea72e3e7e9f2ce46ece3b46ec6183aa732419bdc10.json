{"ast":null,"code":"import { useMenuStore } from '@/stores/menu';\nimport { ElMessage, ElMessageBox } from 'element-plus';\nimport { Picture } from '@element-plus/icons-vue';\nimport MenuUpdateCard from './MenuUpdateCard.vue';\nimport MenuAddCard from './MenuAddCard.vue';\nexport default {\n  name: 'MenuForm',\n  components: {\n    Picture,\n    MenuUpdateCard,\n    MenuAddCard\n  },\n  data() {\n    return {\n      menuData: [],\n      updateDialogVisible: false,\n      currentDish: null,\n      addDialogVisible: false,\n      addDishForm: null\n    };\n  },\n  mounted() {\n    this.getMenuList();\n  },\n  methods: {\n    async getMenuList() {\n      try {\n        const menuStore = useMenuStore();\n        await menuStore.fetchMenuList();\n        this.menuData = menuStore.menuList || [];\n        if (this.menuData.length > 0) {\n          ElMessage.success(`成功获取 ${this.menuData.length} 个菜品信息`);\n        } else {\n          ElMessage.warning('暂无菜品数据');\n        }\n      } catch (error) {\n        ElMessage.error('获取菜单失败: ' + (error.message || error));\n        console.error('获取菜单失败:', error);\n      }\n    },\n    viewDish(dish) {\n      ElMessage.info(`查看菜品: ${dish.dishName || dish.dish_name}`);\n      console.log('菜品详情:', dish);\n    },\n    async deleteDish(dish) {\n      try {\n        await ElMessageBox.confirm(`确定要删除菜品 \"${dish.dishName || dish.dish_name}\" 吗？`, '确认删除', {\n          confirmButtonText: '确定',\n          cancelButtonText: '取消',\n          type: 'warning'\n        });\n        const menuStore = useMenuStore();\n        await menuStore.deleteDish(dish.dishId);\n        ElMessage.success('删除成功');\n        // 重新获取列表\n        this.getMenuList();\n      } catch (error) {\n        if (error !== 'cancel') {\n          ElMessage.error('删除失败: ' + error.message);\n        }\n      }\n    },\n    updateDish(dish) {\n      this.currentDish = dish;\n      this.updateDialogVisible = true;\n      console.log('菜品详情:', dish);\n    },\n    handleUpdateSuccess() {\n      this.updateDialogVisible = false;\n      this.getMenuList();\n      ElMessage.success('菜品更新成功');\n      this.currentDish = null;\n    },\n    handleDialogClose() {\n      this.currentDish = null;\n    },\n    addDish() {\n      this.addDishForm = {\n        dishId: '',\n        dishName: '',\n        price: '',\n        description: '',\n        imageUrl: ''\n      };\n      this.addDialogVisible = true;\n    },\n    handleAddSuccess() {\n      this.addDialogVisible = false;\n      this.getMenuList();\n      ElMessage.success('菜品添加成功');\n      this.addDishForm = null;\n    }\n  }\n};","map":{"version":3,"names":["useMenuStore","ElMessage","ElMessageBox","Picture","MenuUpdateCard","MenuAddCard","name","components","data","menuData","updateDialogVisible","currentDish","addDialogVisible","addDishForm","mounted","getMenuList","methods","menuStore","fetchMenuList","menuList","length","success","warning","error","message","console","viewDish","dish","info","dishName","dish_name","log","deleteDish","confirm","confirmButtonText","cancelButtonText","type","dishId","updateDish","handleUpdateSuccess","handleDialogClose","addDish","price","description","imageUrl","handleAddSuccess"],"sources":["D:\\数据库课程设计（饭店系统）\\restaurant-ordering-system\\src\\components\\menu\\MenuForm.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <span class=\"flex justify-between items-center mb-5\">\r\n      <h2 class=\"m-0 text-gray-800 text-xl font-bold\">全部菜品信息</h2>\r\n      <div class=\"flex gap-2\">\r\n        <el-button type=\"primary\" @click=\"getMenuList\" >\r\n          刷新菜品列表\r\n        </el-button>\r\n        <el-button type=\"primary\" @click=\"addDish\">\r\n          添加菜品\r\n        </el-button>\r\n      </div>\r\n      <!--span中的div不会换行-->\r\n    </span>\r\n    \r\n    <el-table\r\n      :data=\"menuData\"\r\n      style=\"width: 100%\"\r\n      stripe\r\n      border>\r\n      <el-table-column\r\n        prop=\"dishId\"\r\n        label=\"菜品ID\"\r\n        width=\"120\"\r\n        align=\"center\">\r\n      </el-table-column>\r\n      <el-table-column\r\n        prop=\"dishName\"\r\n        label=\"菜品名称\"\r\n        width=\"180\"\r\n        align=\"center\">\r\n        <template #default=\"scope\">\r\n          {{ scope.row.dishName || scope.row.dish_name || '未知菜品' }}\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column\r\n        prop=\"price\"\r\n        label=\"价格\"\r\n        width=\"120\"\r\n        align=\"center\">\r\n        <template #default=\"scope\">\r\n          ¥{{ scope.row.price || '0.00' }}\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column\r\n        prop=\"description\"\r\n        label=\"描述\"\r\n        min-width=\"200\"\r\n        show-overflow-tooltip>\r\n        <template #default=\"scope\">\r\n          {{ scope.row.description || '暂无描述' }}\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column\r\n        prop=\"imageUrl\"\r\n        label=\"图片\"\r\n        width=\"200\"\r\n        align=\"center\">\r\n        <template #default=\"scope\">\r\n          <el-image\r\n            :src=\"scope.row.imageUrl || scope.row.image_url || 'https://images.unsplash.com/photo-1567620905732-2d1ec7ab7445?w=200&h=150&fit=crop'\"\r\n            class=\"w-20 h-20\"\r\n            fit=\"cover\"\r\n            :preview-src-list=\"[scope.row.imageUrl || scope.row.image_url || 'https://images.unsplash.com/photo-1567620905732-2d1ec7ab7445?w=200&h=150&fit=crop']\">\r\n            <template #error>\r\n              <div class=\"flex justify-center items-center w-20 h-20 bg-gray-100 text-gray-500 text-xl\">\r\n                <el-icon><Picture /></el-icon>\r\n              </div>\r\n            </template>\r\n          </el-image>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column\r\n        label=\"操作\"\r\n        width=\"150\"\r\n        align=\"center\"\r\n        fixed=\"right\">\r\n        <template #default=\"scope\">\r\n          <el-button size=\"small\" type=\"primary\" @click=\"updateDish(scope.row)\">\r\n            更新\r\n          </el-button>\r\n          <el-button size=\"small\" type=\"danger\" @click=\"deleteDish(scope.row)\">\r\n            删除\r\n          </el-button>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n    \r\n    <!-- 无数据提示 -->\r\n    <div v-if=\"!menuData || menuData.length === 0\" class=\"flex justify-center items-center min-h-50\">\r\n      <el-empty description=\"暂无菜品数据\" />\r\n    </div>\r\n\r\n    <!-- 更新菜品对话框 -->\r\n    <el-dialog v-model=\"updateDialogVisible\" title=\"更新菜品\" width=\"500px\" @closed=\"handleDialogClose\">\r\n        <MenuUpdateCard v-if=\"currentDish\" :dish=\"currentDish\" @update-success=\"handleUpdateSuccess\" @close=\"updateDialogVisible = false\" />\r\n    </el-dialog>\r\n    <el-dialog v-model=\"addDialogVisible\" title=\"添加菜品\" width=\"500px\" @closed=\"handleDialogClose\">\r\n      <MenuAddCard v-if=\"addDishForm\" :dish=\"addDishForm\" @add-success=\"handleAddSuccess\" @close=\"addDialogVisible = false\" />\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { useMenuStore } from '@/stores/menu'\r\nimport { ElMessage, ElMessageBox } from 'element-plus'\r\nimport { Picture } from '@element-plus/icons-vue'\r\nimport MenuUpdateCard from './MenuUpdateCard.vue'\r\nimport MenuAddCard from './MenuAddCard.vue'\r\nexport default {\r\n  name: 'MenuForm',\r\n  components: {\r\n    Picture,\r\n    MenuUpdateCard,\r\n    MenuAddCard\r\n  },\r\n  data() {\r\n    return {\r\n      menuData: [],\r\n      updateDialogVisible: false,\r\n      currentDish: null,\r\n      addDialogVisible: false,\r\n      addDishForm: null\r\n    }\r\n  },\r\n  mounted() {\r\n    this.getMenuList()\r\n  },\r\n  methods: {\r\n    async getMenuList() {\r\n      try {\r\n        const menuStore = useMenuStore()\r\n        await menuStore.fetchMenuList()\r\n        this.menuData = menuStore.menuList || []\r\n        \r\n        if (this.menuData.length > 0) {\r\n          ElMessage.success(`成功获取 ${this.menuData.length} 个菜品信息`)\r\n        } else {\r\n          ElMessage.warning('暂无菜品数据')\r\n        }\r\n      } catch (error) {\r\n        ElMessage.error('获取菜单失败: ' + (error.message || error))\r\n        console.error('获取菜单失败:', error)\r\n      }\r\n    },\r\n    \r\n    viewDish(dish) {\r\n      ElMessage.info(`查看菜品: ${dish.dishName || dish.dish_name}`)\r\n      console.log('菜品详情:', dish)\r\n    },\r\n    \r\n    async deleteDish(dish) {\r\n      try {\r\n        await ElMessageBox.confirm(\r\n          `确定要删除菜品 \"${dish.dishName || dish.dish_name}\" 吗？`,\r\n          '确认删除',\r\n          {\r\n            confirmButtonText: '确定',\r\n            cancelButtonText: '取消',\r\n            type: 'warning',\r\n          }\r\n        )\r\n        const menuStore = useMenuStore()\r\n        await menuStore.deleteDish(dish.dishId)\r\n        ElMessage.success('删除成功')\r\n        // 重新获取列表\r\n        this.getMenuList()\r\n      } catch (error) {\r\n        if (error !== 'cancel') {\r\n          ElMessage.error('删除失败: ' + error.message)\r\n        }\r\n      }\r\n    },\r\n\r\n    updateDish(dish) {\r\n      this.currentDish = dish\r\n      this.updateDialogVisible = true\r\n      console.log('菜品详情:', dish)\r\n    },\r\n\r\n    handleUpdateSuccess() {\r\n        this.updateDialogVisible = false;\r\n        this.getMenuList();\r\n        ElMessage.success('菜品更新成功');\r\n        this.currentDish = null;\r\n    },\r\n\r\n    handleDialogClose() {\r\n        this.currentDish = null;\r\n    },\r\n\r\n    addDish() {\r\n        this.addDishForm = {\r\n            dishId: '',\r\n            dishName: '',\r\n            price: '',\r\n            description: '',\r\n            imageUrl: ''\r\n        };\r\n        this.addDialogVisible = true;\r\n    },\r\n\r\n    handleAddSuccess() {\r\n        this.addDialogVisible = false;\r\n        this.getMenuList();\r\n        ElMessage.success('菜品添加成功');\r\n        this.addDishForm = null;\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n"],"mappings":"AAwGA,SAASA,YAAW,QAAS,eAAc;AAC3C,SAASC,SAAS,EAAEC,YAAW,QAAS,cAAa;AACrD,SAASC,OAAM,QAAS,yBAAwB;AAChD,OAAOC,cAAa,MAAO,sBAAqB;AAChD,OAAOC,WAAU,MAAO,mBAAkB;AAC1C,eAAe;EACbC,IAAI,EAAE,UAAU;EAChBC,UAAU,EAAE;IACVJ,OAAO;IACPC,cAAc;IACdC;EACF,CAAC;EACDG,IAAIA,CAAA,EAAG;IACL,OAAO;MACLC,QAAQ,EAAE,EAAE;MACZC,mBAAmB,EAAE,KAAK;MAC1BC,WAAW,EAAE,IAAI;MACjBC,gBAAgB,EAAE,KAAK;MACvBC,WAAW,EAAE;IACf;EACF,CAAC;EACDC,OAAOA,CAAA,EAAG;IACR,IAAI,CAACC,WAAW,CAAC;EACnB,CAAC;EACDC,OAAO,EAAE;IACP,MAAMD,WAAWA,CAAA,EAAG;MAClB,IAAI;QACF,MAAME,SAAQ,GAAIjB,YAAY,CAAC;QAC/B,MAAMiB,SAAS,CAACC,aAAa,CAAC;QAC9B,IAAI,CAACT,QAAO,GAAIQ,SAAS,CAACE,QAAO,IAAK,EAAC;QAEvC,IAAI,IAAI,CAACV,QAAQ,CAACW,MAAK,GAAI,CAAC,EAAE;UAC5BnB,SAAS,CAACoB,OAAO,CAAC,QAAQ,IAAI,CAACZ,QAAQ,CAACW,MAAM,QAAQ;QACxD,OAAO;UACLnB,SAAS,CAACqB,OAAO,CAAC,QAAQ;QAC5B;MACF,EAAE,OAAOC,KAAK,EAAE;QACdtB,SAAS,CAACsB,KAAK,CAAC,UAAS,IAAKA,KAAK,CAACC,OAAM,IAAKD,KAAK,CAAC;QACrDE,OAAO,CAACF,KAAK,CAAC,SAAS,EAAEA,KAAK;MAChC;IACF,CAAC;IAEDG,QAAQA,CAACC,IAAI,EAAE;MACb1B,SAAS,CAAC2B,IAAI,CAAC,SAASD,IAAI,CAACE,QAAO,IAAKF,IAAI,CAACG,SAAS,EAAE;MACzDL,OAAO,CAACM,GAAG,CAAC,OAAO,EAAEJ,IAAI;IAC3B,CAAC;IAED,MAAMK,UAAUA,CAACL,IAAI,EAAE;MACrB,IAAI;QACF,MAAMzB,YAAY,CAAC+B,OAAO,CACxB,YAAYN,IAAI,CAACE,QAAO,IAAKF,IAAI,CAACG,SAAS,MAAM,EACjD,MAAM,EACN;UACEI,iBAAiB,EAAE,IAAI;UACvBC,gBAAgB,EAAE,IAAI;UACtBC,IAAI,EAAE;QACR,CACF;QACA,MAAMnB,SAAQ,GAAIjB,YAAY,CAAC;QAC/B,MAAMiB,SAAS,CAACe,UAAU,CAACL,IAAI,CAACU,MAAM;QACtCpC,SAAS,CAACoB,OAAO,CAAC,MAAM;QACxB;QACA,IAAI,CAACN,WAAW,CAAC;MACnB,EAAE,OAAOQ,KAAK,EAAE;QACd,IAAIA,KAAI,KAAM,QAAQ,EAAE;UACtBtB,SAAS,CAACsB,KAAK,CAAC,QAAO,GAAIA,KAAK,CAACC,OAAO;QAC1C;MACF;IACF,CAAC;IAEDc,UAAUA,CAACX,IAAI,EAAE;MACf,IAAI,CAAChB,WAAU,GAAIgB,IAAG;MACtB,IAAI,CAACjB,mBAAkB,GAAI,IAAG;MAC9Be,OAAO,CAACM,GAAG,CAAC,OAAO,EAAEJ,IAAI;IAC3B,CAAC;IAEDY,mBAAmBA,CAAA,EAAG;MAClB,IAAI,CAAC7B,mBAAkB,GAAI,KAAK;MAChC,IAAI,CAACK,WAAW,CAAC,CAAC;MAClBd,SAAS,CAACoB,OAAO,CAAC,QAAQ,CAAC;MAC3B,IAAI,CAACV,WAAU,GAAI,IAAI;IAC3B,CAAC;IAED6B,iBAAiBA,CAAA,EAAG;MAChB,IAAI,CAAC7B,WAAU,GAAI,IAAI;IAC3B,CAAC;IAED8B,OAAOA,CAAA,EAAG;MACN,IAAI,CAAC5B,WAAU,GAAI;QACfwB,MAAM,EAAE,EAAE;QACVR,QAAQ,EAAE,EAAE;QACZa,KAAK,EAAE,EAAE;QACTC,WAAW,EAAE,EAAE;QACfC,QAAQ,EAAE;MACd,CAAC;MACD,IAAI,CAAChC,gBAAe,GAAI,IAAI;IAChC,CAAC;IAEDiC,gBAAgBA,CAAA,EAAG;MACf,IAAI,CAACjC,gBAAe,GAAI,KAAK;MAC7B,IAAI,CAACG,WAAW,CAAC,CAAC;MAClBd,SAAS,CAACoB,OAAO,CAAC,QAAQ,CAAC;MAC3B,IAAI,CAACR,WAAU,GAAI,IAAI;IAC3B;EACF;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}