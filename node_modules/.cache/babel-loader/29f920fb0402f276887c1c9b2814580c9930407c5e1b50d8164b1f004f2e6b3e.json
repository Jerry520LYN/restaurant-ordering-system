{"ast":null,"code":"import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport { defineStore } from 'pinia';\nimport { getMenuList, getHotDishes, deleteDish as deleteDishApi, addDish } from '@/api/menu';\nimport { useAuthStore } from './auth';\nexport const useMenuStore = defineStore('menu', {\n  state: () => ({\n    menuList: [],\n    hotDishes: [],\n    loading: false,\n    error: null\n  }),\n  actions: {\n    async fetchMenuList() {\n      this.loading = true;\n      try {\n        const response = await getMenuList();\n        console.log('fetchMenuList - 获取到的result:', response);\n        this.menuList = response || [];\n      } catch (error) {\n        console.error('fetchMenuList - 错误:', error);\n        this.error = error;\n      } finally {\n        this.loading = false;\n      }\n    },\n    async fetchHotDishes(startTime, endTime) {\n      this.loading = true;\n      this.error = null;\n      try {\n        const authStore = useAuthStore();\n        if (!authStore.token) {\n          throw new Error('请先登录');\n        }\n\n        // 确保时间格式为 yyyy-MM-dd（只有日期，没有时分秒）\n        const formatDate = date => {\n          if (typeof date === 'string') {\n            return date.split(' ')[0]; // 只取日期部分\n          }\n          return date;\n        };\n        const formattedStartTime = formatDate(startTime);\n        const formattedEndTime = formatDate(endTime);\n        console.log('fetchHotDishes - 请求参数:', {\n          startTime: formattedStartTime,\n          endTime: formattedEndTime\n        });\n        const response = await getHotDishes(formattedStartTime, formattedEndTime);\n        console.log('fetchHotDishes - 获取到的result:', response);\n        this.hotDishes = response || [];\n      } catch (error) {\n        console.error('fetchHotDishes - 错误:', error);\n        this.error = error;\n        this.hotDishes = [];\n      } finally {\n        this.loading = false;\n      }\n    },\n    async addDish(dish) {\n      try {\n        const response = await addDish(dish);\n        console.log('addDish - 添加结果:', response);\n        return response;\n      } catch (error) {\n        console.error('addDish - 错误:', error);\n        this.error = error;\n      }\n    },\n    async deleteDish(dishId) {\n      this.loading = true;\n      this.error = null;\n      try {\n        await deleteDishApi(dishId);\n        // 可选：从menuList中移除已删除的项，以避免重新获取整个列表\n        this.menuList = this.menuList.filter(dish => dish.dishId !== dishId);\n      } catch (error) {\n        console.error('deleteDish - 错误:', error);\n        this.error = error;\n        throw error; // 将错误向上抛出，以便组件可以捕获它\n      } finally {\n        this.loading = false;\n      }\n    }\n  }\n});","map":{"version":3,"names":["defineStore","getMenuList","getHotDishes","deleteDish","deleteDishApi","addDish","useAuthStore","useMenuStore","state","menuList","hotDishes","loading","error","actions","fetchMenuList","response","console","log","fetchHotDishes","startTime","endTime","authStore","token","Error","formatDate","date","split","formattedStartTime","formattedEndTime","dish","dishId","filter"],"sources":["D:/数据库课程设计（饭店系统）/restaurant-ordering-system/src/stores/menu.js"],"sourcesContent":["import { defineStore } from 'pinia';\r\nimport { getMenuList, getHotDishes, deleteDish as deleteDishApi, addDish } from '@/api/menu';\r\nimport { useAuthStore } from './auth';\r\n\r\nexport const useMenuStore = defineStore('menu', {\r\n    state: () => ({\r\n        menuList: [],\r\n        hotDishes: [],\r\n        loading: false,\r\n        error: null\r\n    }),\r\n    actions: {\r\n        async fetchMenuList() {\r\n            this.loading = true;\r\n            try {\r\n                const response = await getMenuList();\r\n                console.log('fetchMenuList - 获取到的result:', response);\r\n                this.menuList = response || [];\r\n            } catch (error) {\r\n                console.error('fetchMenuList - 错误:', error);\r\n                this.error = error;\r\n            } finally {\r\n                this.loading = false;\r\n            }\r\n        },\r\n        async fetchHotDishes(startTime, endTime) {\r\n            this.loading = true;\r\n            this.error = null;\r\n            try {\r\n                const authStore = useAuthStore();\r\n                if (!authStore.token) {\r\n                    throw new Error('请先登录');\r\n                }\r\n                \r\n                // 确保时间格式为 yyyy-MM-dd（只有日期，没有时分秒）\r\n                const formatDate = (date) => {\r\n                    if (typeof date === 'string') {\r\n                        return date.split(' ')[0]; // 只取日期部分\r\n                    }\r\n                    return date;\r\n                };\r\n                \r\n                const formattedStartTime = formatDate(startTime);\r\n                const formattedEndTime = formatDate(endTime);\r\n                \r\n                console.log('fetchHotDishes - 请求参数:', { startTime: formattedStartTime, endTime: formattedEndTime });\r\n                const response = await getHotDishes(formattedStartTime, formattedEndTime);\r\n                console.log('fetchHotDishes - 获取到的result:', response);\r\n                this.hotDishes = response || [];\r\n            } catch (error) {\r\n                console.error('fetchHotDishes - 错误:', error);\r\n                this.error = error;\r\n                this.hotDishes = [];\r\n            } finally {\r\n                this.loading = false;\r\n            }\r\n        },\r\n        async addDish(dish) {\r\n            try {\r\n                const response = await addDish(dish);\r\n                console.log('addDish - 添加结果:', response);\r\n                return response;\r\n            } catch (error) {\r\n                console.error('addDish - 错误:', error);\r\n                this.error = error;\r\n            }\r\n        },\r\n        async deleteDish(dishId) {\r\n            this.loading = true;\r\n            this.error = null;\r\n            try {\r\n                await deleteDishApi(dishId);\r\n                // 可选：从menuList中移除已删除的项，以避免重新获取整个列表\r\n                this.menuList = this.menuList.filter(dish => dish.dishId !== dishId);\r\n            } catch (error) {\r\n                console.error('deleteDish - 错误:', error);\r\n                this.error = error;\r\n                throw error; // 将错误向上抛出，以便组件可以捕获它\r\n            } finally {\r\n                this.loading = false;\r\n            }\r\n        }\r\n    }\r\n});\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}